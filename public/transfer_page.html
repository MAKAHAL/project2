<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTF-8" />
    <title>Banki</title>

    <!-- css file -->
    <link rel="stylesheet" href="./css/style.css" />
    <!-- bootstrap css -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!-- bootstrap jquery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- Bootstrap Date-Picker Plugin -->
    <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/js/bootstrap-datepicker.min.js"></script>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/css/bootstrap-datepicker3.css" />

    <!-- jquery ui -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
        integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
</head>


<body style="background-color:whitesmoke">
    <!-- nav bar one -->
    <ul id="bar-one">
        <div class="topnav-center">
            <a>BANKI</a>
        </div>
        <div class="topnav-right">
            <a>Logout</a>
        </div>
    </ul>

    <!-- nav bar two -->
    <ul id="bar-two">
        <li id="bar-li"><a class="bar-text" id="transfer-page">Pay & Transfer</a></li>
        <li id="bar-li"><a class="bar-text" id="account-create-page">Open Account</a></li>
        <li id="bar-li"><a class="bar-text" id="account-page">Accounts</a></li>
    </ul>

    <div class="container">
        <div class="flex-item transfer-one">
            <div class="flex-item" id="contacts-box">
                <p class="subtitles">WALLIE</p>
                <input type="text" placeholder="Search Recipient" id="contact-query">
                <button id="search-contact">Search</button>
                <p></p>
                <p class="subtitles">CONTACTS</p>
                <p></p>
                <div></div>
                <table id="contact-table">
                    <tr>
                        <td>Name</td>
                        <td>Phone Number</td>
                        <td>Email</td>
                    </tr>
                </table>
                <p id='socket-info'></p>
                <button class="right-align-button" id="pay">Pay</button>


            </div>
            <div class="flex-item" id="add-contacts-box">
                <p class="subtitles">Add Recipient</p>
                <input type="text" placeholder="Contact Name" id="contact-name">
                <input type="numer" placeholder="Phone Number" id="contact-phone">
                <input type="text" placeholder="E-mail" id="contact-email">
                <p></p>
                <button class="right-align-button" id="add-contact">Add Recipient</button>
            </div>
        </div>

        <div class="flex-item transfer-two">
            <div class="flex-item" id="available-box">
                <p class="subtitles">AVAILABLE BALANCE</p>
                <p class="right-align numbers">$30,029.00</p>
                <p class="right-align">Checking Account</p>


            </div>
            <div class="flex-item" id="transactions-box">
                <p class="subtitles">TRANSACTIONS</p>
                <input type="text" placeholder="Search.." id="transaction-query">
                <button id="search-transaction">Search</button>
                <p></p>
                <table id="transactions-table">
                    <tr>
                        <th>Sent to</th>
                        <th>Amount</th>
                        <th>Date</th>
                    </tr>
                    <tr>
                        <td>Makah</td>
                        <td>$7.09</td>
                        <td>Feb 21, 2019</td>
                    </tr>
                    <tr>
                        <td>Zaid</td>
                        <td>$45.21</td>
                        <td>Feb 21, 2019</td>
                    </tr>
                    <tr>
                        <td>Chae</td>
                        <td>$23.50</td>
                        <td>Feb 21, 2019</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>


    <!-- transfer alert -->
    <div class='modal' id="modal">
        <div class="modal-content">
            <form>
                <p>Send to:</p>
                <input type="text" id="send-to">
                <p>Send on:</p>
                <input class="form-control" id="date" name="date" placeholder="MM/DD/YYY" type="text" />
                <p>Amount:</p>
                <input type="number" id="amount">
                <p></p>
                <button id="cancel-transaction">Cancel</button>
                <button id="send-transaction">Send</button>
            </form>
        </div>
    </div>


    <!-- transfer modal -->


</body>


<script src="js/add.js" type="text/javascript"></script>
<script src="js/all.js" type="text/javascript"></script>
<script src="/socket.io/socket.io.js"></script>
<script>


    // socket function for contacts
    $(document).ready(function(){
        const socket = io();
        $('#add-contact').on('click', function(e){
            e.preventDefault();
            socket.emit('contact added', $('#contact-name').val());
        });
        socket.on('refresh contacts', function(msg){
            $("#socket-info").append(msg + '<br/><br/>');
        });
    });

    // calendar in modal, but need to figure out how to fix the inner css
    $(document).ready(function () {
        var date_input = $('input[name="date"]'); //our date input has the name "date"
        var container = $('.bootstrap-iso form').length > 0 ? $('.bootstrap-iso form').parent() : 'body';
        var options = {
            format: 'mm/dd/yyyy',
            container: container,
            todayHighlight: true,
            autoclose: true,
        };
        date_input.datepicker(options);
    });


    // live search code input [contacts]
    $(document).ready(function () {
        $('#contact-query').keyup(function () {
            let searchField = $('#contact-query').val();
            let expression = new RegExp(searchField, 'i');

            // how can i have the th stay?
            $('#contact-table tr').each(function () {
                if ($(this).text().search(expression) < 0) {
                    $(this).fadeOut();
                } else {
                    $(this).show();
                }
            });

        });
    });

    // live search code input [transactions]
    $(document).ready(function () {
        $('#transaction-query').keyup(function () {
            let searchField = $('#transaction-query').val();
            let expression = new RegExp(searchField, 'i');

            // how can I have the th stay?
            // $(this).prepend(
            //     '<tr><td>' + 'Transaction' + '</td>' +
            //     '<td>' + 'Amount' + '</td>' +
            //     '<td>' + 'Balance' + '</td></tr>'
            // )
            $('#transactions-table tr').each(function () {
                if ($(this).text().search(expression) < 0) {
                    $(this).fadeOut();
                } else {
                    $(this).show();
                }
            });

        });
    });

    // live search code input [transactions]
    $(document).ready(function () {
        $('#transaction-query').keyup(function () {
            // $('#result').html('');
            let searchField = $('#transaction-query').val();
            let expression = new RegExp(searchField, 'i');

            // how can I have the th stay?
            // $(this).prepend(
            //     '<tr><td>' + 'Transaction' + '</td>' +
            //     '<td>' + 'Amount' + '</td>' +
            //     '<td>' + 'Balance' + '</td></tr>'
            // )
            $('#transactions-table tr').each(function () {
                if ($(this).text().search(expression) < 0) {
                    $(this).fadeOut();
                } else {
                    $(this).show();
                }
            });

        });
    });

    // modal
    $('#pay').on('click', function () {
        modal.style.display = "block";
    });
    $('#cancel-transaction').on('click', function(e){
        e.preventDefault();
        $('#modal').hide();
    });

    // html links 
    $('#account-page').on('click', function () {
        location.href = 'home_page.html';
    });
    $('#account-create-page').on('click', function () {
        location.href = 'account_create_page.html';
    });
    $('#transfer-page').on('click', function () {
        location.href = 'transfer_page.html';
    });
</script>

</html>